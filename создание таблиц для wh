DROP  table testdb.winemag;
CREATE table testdb.winemag(
nrow UInt8,
country String,
description String,
destination String,
points UInt8,
price Float,
province String,
region_1 String,
region_2 String,
tester_name String,
tester_twitt String, 
title String,
winery String)
engine=MergeTree()
order by nrow;

//clickhouse-client -h 127.0.0.1 -u default --password qw123456 --format_csv_delimiter="," --query "insert into testdb.winemag FORMAT CSV" < winemag-data-130k-v2-noheader.csv

select country , max(price) max_price
FROM testdb.winemag
where country <> '' and  country is not NULL and price is not null and price <>0
group by country 
order by max_price desc 
limit 10;

CREATE TABLE Manager (
  ManagerID UInt32,
  PersonID UInt32,
  DepartmentID UInt32
) ENGINE = MergeTree()
ORDER BY ManagerID;

-- Таблица Person
CREATE TABLE Person (
  PersonID UInt32,
  Name String,
  Surname String,
  SocialSecurityID UInt64,
  CompanyID UInt32
) ENGINE = MergeTree()
ORDER BY PersonID;

-- Таблица Employee
CREATE TABLE Employee (
  EmployeeID UInt32,
  PersonID UInt32,
  Position String
) ENGINE = MergeTree()
ORDER BY EmployeeID;

-- Таблица Company
CREATE TABLE Company (
  CompanyID UInt32,
  Name String,
  Location String
) ENGINE = MergeTree()
ORDER BY CompanyID;

-- Таблица CompanyDepartment
CREATE TABLE CompanyDepartment (
  CompanyID UInt32,
  DepartmentID UInt32
) ENGINE = MergeTree()
ORDER BY (CompanyID, DepartmentID);

-- Таблица Department
CREATE TABLE Department (
  DepartmentID UInt32,
  Name String,
  Description String
) ENGINE = MergeTree()
ORDER BY DepartmentID;
